{% extends 'base.html' %}

{% block extra_css %}
 <style>
     .ratings-hero {
         border-radius: 18px;
         background: radial-gradient(900px circle at 10% 0%, rgba(229, 9, 20, 0.22), transparent 55%),
                     radial-gradient(900px circle at 100% 10%, rgba(102, 126, 234, 0.30), transparent 55%),
                     linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.65));
         border: 1px solid rgba(255,255,255,0.06);
     }

     .panel {
         background: rgba(0,0,0,0.35);
         border: 1px solid rgba(255,255,255,0.08);
         border-radius: 14px;
     }

     .chip {
         display: inline-flex;
         align-items: center;
         gap: 0.35rem;
         padding: 0.35rem 0.7rem;
         border-radius: 999px;
         font-size: 0.85rem;
         background: rgba(255,255,255,0.06);
         border: 1px solid rgba(255,255,255,0.08);
         color: rgba(255,255,255,0.85);
     }
 </style>
{% endblock %}

{% block content %}
 <div class="container mt-4">
     <div class="ratings-hero p-3 p-lg-4 mb-4">
         <div class="row align-items-center g-4">
             <div class="col-lg-7">
                 <h1 class="display-6 fw-bold mb-2">Mes Notations</h1>
                 <p class="text-muted mb-0">Retrouve toutes tes notes et retourne facilement sur les pages des séries.</p>
             </div>
             <div class="col-lg-5">
                 <div class="panel p-2">
                     <div class="d-flex flex-wrap gap-2 align-items-center">
                         <span class="chip">
                             <i class="fas fa-star"></i>
                             {{ ratings|length }} notation(s)
                         </span>
                         <a href="{% url 'recommendations:series_list' %}" class="btn btn-primary btn-sm ms-auto">
                             Explorer le catalogue
                         </a>
                     </div>
                 </div>
             </div>
         </div>
     </div>

     {% if ratings %}
     <div class="card">
         <div class="card-header d-flex align-items-center justify-content-between">
             <h4 class="mb-0">Historique</h4>
             <span class="text-muted small">Les plus récentes apparaissent en premier</span>
         </div>
         <div class="card-body">
             <div class="table-responsive">
                 <table class="table table-dark table-hover align-middle mb-0">
                     <thead>
                         <tr>
                             <th>Série</th>
                             <th>Genres</th>
                             <th>Ma note</th>
                             <th>Date</th>
                             <th class="text-end">Action</th>
                         </tr>
                     </thead>
                     <tbody>
                         {% for rating in ratings %}
                         <tr>
                             <td>
                                 <a href="{% url 'recommendations:series_detail' rating.series_title %}">
                                     {{ rating.series_title }}
                                 </a>
                             </td>
                             <td>
                                 {% if rating.genres %}
                                     {% for genre in rating.genres|slice:":3" %}
                                     <span class="genre-badge">{{ genre }}</span>
                                     {% endfor %}
                                 {% else %}
                                     <span class="chip">—</span>
                                 {% endif %}
                             </td>
                             <td>
                                 <span class="star-rating">
                                     {% for i in "12345" %}
                                         {% if forloop.counter <= rating.score %}
                                         <i class="fas fa-star"></i>
                                         {% else %}
                                         <i class="far fa-star"></i>
                                         {% endif %}
                                     {% endfor %}
                                 </span>
                                 <span class="ms-2 text-muted">{{ rating.score }}/5</span>
                             </td>
                             <td>
                                 {% if rating.date %}
                                     {{ rating.date|date:"d/m/Y" }}
                                 {% else %}
                                     —
                                 {% endif %}
                             </td>
                             <td class="text-end">
                                 <a href="{% url 'recommendations:series_detail' rating.series_title %}" class="btn btn-sm btn-outline-light">
                                     Voir
                                 </a>
                             </td>
                         </tr>
                         {% endfor %}
                     </tbody>
                 </table>
             </div>
         </div>
     </div>
     {% else %}
     <div class="card p-5 text-center">
         <h2 class="h4 mb-2">Aucune notation</h2>
         <p class="text-muted mb-3">Commence par noter quelques séries pour débloquer les recommandations.</p>
         <div class="d-flex justify-content-center gap-2">
             <a href="{% url 'recommendations:series_list' %}" class="btn btn-primary">Explorer le catalogue</a>
             <a href="{% url 'recommendations:recommendations' %}" class="btn btn-outline-light">Mes recommandations</a>
         </div>
     </div>
     {% endif %}
 </div>
{% endblock %}